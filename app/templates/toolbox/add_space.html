{% extends "toolbox/tbase.html" %}
{% import "bootstrap/wtf.html" as wtf %}



{% block row %}
<div class="page-header">
    <h1>表空间使用情况</h1>
</div>
    {% if logs != "doing" %}
        {% if  logs != "添加成功！" %}
                <div id="alert" class="alert alert-warning " >
                    <a href="#" class="close" data-dismiss="alert" disabled>
                        &times;
                    </a>
                    <strong>数据文件添加失败！原因是：</strong>{{ logs }}
                </div>
        {% else%}
            <div id="alert" class="alert alert-success " >
                <a href="#" class="close" data-dismiss="alert" disabled>
                    &times;
                </a>
                <strong></strong>{{ logs }}
            </div>
        {% endif %}
    {% endif %}
<form role="form" method="post" name="my_form">
<div class="col-lg-12" style="margin-top: 10px">
                        <!-- /.panel-heading -->
                        <div class="panel-body">
                            <table width="100%" class="table table-striped table-bordered table-hover" >
                                <thead>
                                    <tr class="even gradeC">
                                    {%  for p in col_list %}
                                            <th>{{ p }}</th>
                                    {% endfor %}
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for i in value_list %}
                                        <tr>
                                        {% if i[2] == None %}
                                             <td>
                                                <div class="radio">
                                                    <label>
                                                        <input type="radio" name="optionsRadios" value="{{ i[0] }}">
                                                    </label>
                                                </div>
                                            </td>
                                            <td><button type="submit" class="btn btn-link" name="bn" value="{{ i[0] }}">{{ i[0] }}</button>
                                            </td>
                                            {% for j in i[1:] %}
                                                <td>
                                                {{ j }}
                                                </td>
                                            {% endfor %}
                                        </tr>
                                        {% else %}
                                            <tr>
                                            <td> </td>
                                            <td> </td>
                                            {% for j in i[1:] %}
                                                {% if j == None %}
                                                    <td> </td>
                                                {% else %}
                                                    <td>
                                                    {{ j }}
                                                    </td>
                                                {% endif %}
                                            {% endfor %}
                                        </tr >
                                        {% endif %}
                                    {% endfor %}
                                </tbody>
                            </table>
                            <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                <div class="modal-dialog">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
					                                &times;
                                            </button>
                                            <h4 class="modal-title" id="myModalLabel">
					                                添加配置
                                            </h4>
                                        </div>
                                        <div class="modal-body">
                                                <div style="padding: 80px 80px 20px;">
                                                    <form class="bs-example bs-example-form" role="form">
                                                        <div class="input-group">
                                                            <span class="input-group-addon">表空间名：</span>
                                                            <input type="text" class="form-control"  id="space_name">
                                                        </div>
                                                        <br>
                                                        <div class="input-group">
                                                            <span class="input-group-addon">数据文件路径：</span>
                                                            <input type="text" class="form-control"   name="space_path" id="space_path">
                                                        </div>
                                                        <br>
                                                        <div id="div0" class="input-group">
                                                            <span class="input-group-addon">数据文件大小：</span>
                                                            <input type="text" class="form-control"  name="space_size" id="space_value">
                                                            <span class="input-group-addon">MB</span>
                                                        </div>
                                                        <br>
                                                        <div id="div1" class="input-group">
                                                            <span class="input-group-addon">每次增长大小：</span>
                                                            <input type="text" class="form-control"  name="one_size" id="one_value"  value="100"disabled>
                                                            <span class="input-group-addon">MB</span>
                                                        </div>
                                                        <br>
                                                        <div id="div2" class="input-group">
                                                            <span class="input-group-addon">数据文件最大增长大小：</span>
                                                            <input type="text" class="form-control"  name="max_size" id="max_value" value="10000" disabled>
                                                            <span class="input-group-addon">MB</span>
                                                        </div>
                                                        <div id="div3" class="checkbox">
                                                            <label>
                                                                <input type="checkbox" id="unlimited" name="unlimited" value="ok" disabled>是否开启无限扩展
                                                            </label>
                                                        </div>
                                                        <br>
                                                        <button type="button" class="btn btn-primary " id="extend">
                                                            开启自动扩展
                                                        </button>
                                                        <button type="button" class="btn btn-primary " id="unextend">
                                                            关闭自动扩展
                                                        </button>
                                                        <br>
                                                    </form>
                                                </div>
                                        </div>
                                        <div class="modal-footer">
                                            <button type="button" class="btn btn-default" data-dismiss="modal">关闭
                                            </button>
                                            <button type="submit" id="go" class="btn btn-primary" name="butt" value="ok" >提交</button>
                                        </div>
                                    </div><!-- /.modal-content -->
                                </div><!-- /.modal -->
                            </div>
                        </div>

    <button type="button" class="btn btn-primary btn-lg" data-toggle="modal" data-target="#myModal" onclick="add_space();">
        添加表空间
    </button>
</div>
</form>
{% endblock %}

{% block func %}
    <!-- DataTables JavaScript -->
    <script src="{{ url_for('static',filename='sb-admin/vendor/datatables/js/jquery.dataTables.min.js') }}"></script>
    <script src="{{ url_for('static',filename='sb-admin/vendor/datatables-plugins/dataTables.bootstrap.min.js') }}"></script>
    <script src="{{ url_for('static',filename='sb-admin/vendor/datatables-responsive/dataTables.responsive.js') }}"></script>
    <!-- Page-Level Demo Scripts - Tables - Use for reference -->
    <script>
    $(document).ready(function() {
        $('#dataTables-example').DataTable({
            responsive: true,
            ordering : false
        });
    });

    function add_space() {
        checkItem = $("input[type='radio']:checked");
        if (checkItem.val() == undefined) {
            alert("未选择表空间！")
            return false
        }

        else {
            obj = $.ajax({
                url: "/toolbox/get_space/" + checkItem.val(),
                async: false
            });

            var str1 = JSON.parse(obj.responseText);
            $("#space_value").val(str1.size);
            $("#space_path").val(str1.path);
            $("#space_name").val(str1.name);
        }
    }






    </script>
    <link rel="stylesheet" href="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/css/bootstrap.min.css">
	<script src="http://cdn.static.runoob.com/libs/jquery/2.1.1/jquery.min.js"></script>
	<script src="http://cdn.static.runoob.com/libs/bootstrap/3.3.7/js/bootstrap.min.js"></script>


    <script type="text/javascript">
    $(function() {
        $("#extend").click(function(){
            $("#div1 input").replaceWith("<input type='text' class='form-control'  name='one_size' id='one_value' value='100'>")
            $("#div2 input").replaceWith("<input type='text' class='form-control'  name='max_size' id='max_value' >")
            $("#div3 input").replaceWith("<input type='checkbox' id='unlimited' name='unlimited' value='ok'>");
        });
        $("#unextend").click(function(){
            $("#div1 input").replaceWith("<input type='text' class='form-control'  name='one_size' id='one_value' value='100' disabled>")
            $("#div2 input").replaceWith("<input type='text' class='form-control'  name='max_size' id='max_value' value='10000'  disabled>")
            $("#div3 input").replaceWith("<input type='checkbox' id='unlimited' name='unlimited' value='ok' disabled>");
        });
        $("#go").click(function(){
            $("#alert a").replaceWith("<a href='#' class='close' data-dismiss='alert' >")

        });


    })
</script>
{% endblock %}